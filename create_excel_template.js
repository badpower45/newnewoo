import * as xlsx from 'xlsx';
import { fileURLToPath } from 'url';
import { dirname, join } from 'path';

const __filename = fileURLToPath(import.meta.url);
const __dirname = dirname(__filename);

// Sample data with 10 required columns
const sampleData = [
    {
        'ุงุณู ุงูููุชุฌ': 'ุดููููุงุชุฉ ุฌุงูุงูุณู 100 ุฌุฑุงู',
        'ุงูุจุงุฑููุฏ': '6221155123456',
        'ุงูุณุนุฑ ูุจู': 30.00,
        'ุงูุณุนุฑ ุจุนุฏ': 25.50,
        'ุงูุชุตููู ุงูุงุณุงุณู': 'ุญูููุงุช',
        'ุงูุชุตููู ุงูุซุงููู': 'ุดููููุงุชุฉ',
        'ุงููุฑุน': 1,
        'ุงููููู': 150,
        'ุงูุตูุฑุฉ': 'https://i.imgur.com/abc123.jpg',
        'ุชุงุฑูุฎ ุงูุตูุงุญูู': '2026-12-31'
    },
    {
        'ุงุณู ุงูููุชุฌ': 'ุจูุจุณู 2 ูุชุฑ',
        'ุงูุจุงุฑููุฏ': '6221155789012',
        'ุงูุณุนุฑ ูุจู': 20.00,
        'ุงูุณุนุฑ ุจุนุฏ': 18.00,
        'ุงูุชุตููู ุงูุงุณุงุณู': 'ูุดุฑูุจุงุช',
        'ุงูุชุตููู ุงูุซุงููู': 'ูุดุฑูุจุงุช ุบุงุฒูุฉ',
        'ุงููุฑุน': 1,
        'ุงููููู': 200,
        'ุงูุตูุฑุฉ': 'https://i.imgur.com/xyz789.jpg',
        'ุชุงุฑูุฎ ุงูุตูุงุญูู': '2026-06-30'
    },
    {
        'ุงุณู ุงูููุชุฌ': 'ุดูุจุณู ููุฒ ูุจูุฑ',
        'ุงูุจุงุฑููุฏ': '6221155345678',
        'ุงูุณุนุฑ ูุจู': 15.00,
        'ุงูุณุนุฑ ุจุนุฏ': 12.50,
        'ุงูุชุตููู ุงูุงุณุงุณู': 'ุณูุงูุณ',
        'ุงูุชุตููู ุงูุซุงููู': 'ุดูุจุณ',
        'ุงููุฑุน': 1,
        'ุงููููู': 180,
        'ุงูุตูุฑุฉ': 'https://i.imgur.com/def456.jpg',
        'ุชุงุฑูุฎ ุงูุตูุงุญูู': '2026-09-15'
    },
    {
        'ุงุณู ุงูููุชุฌ': 'ูุจู ูุงุฏู ูุงูู ุงูุฏุณู 1 ูุชุฑ',
        'ุงูุจุงุฑููุฏ': '6221155456789',
        'ุงูุณุนุฑ ูุจู': 18.00,
        'ุงูุณุนุฑ ุจุนุฏ': 16.50,
        'ุงูุชุตููู ุงูุงุณุงุณู': 'ุฃูุจุงู',
        'ุงูุชุตููู ุงูุซุงููู': 'ูุจู',
        'ุงููุฑุน': 1,
        'ุงููููู': 120,
        'ุงูุตูุฑุฉ': 'https://i.imgur.com/milk123.jpg',
        'ุชุงุฑูุฎ ุงูุตูุงุญูู': '2026-01-15'
    },
    {
        'ุงุณู ุงูููุชุฌ': 'ุฃุฑุฒ ูุตุฑู ุฃุจู ุจูุชูู 1 ูุฌู',
        'ุงูุจุงุฑููุฏ': '6221155567890',
        'ุงูุณุนุฑ ูุจู': 25.00,
        'ุงูุณุนุฑ ุจุนุฏ': 22.00,
        'ุงูุชุตููู ุงูุงุณุงุณู': 'ุจูุงูุฉ',
        'ุงูุชุตููู ุงูุซุงููู': 'ุฃุฑุฒ',
        'ุงููุฑุน': 1,
        'ุงููููู': 300,
        'ุงูุตูุฑุฉ': 'https://i.imgur.com/rice456.jpg',
        'ุชุงุฑูุฎ ุงูุตูุงุญูู': '2027-12-31'
    }
];

// Create workbook and worksheet
const worksheet = xlsx.utils.json_to_sheet(sampleData);

// Set column widths
const columnWidths = [
    { wch: 30 }, // ุงุณู ุงูููุชุฌ
    { wch: 15 }, // ุงูุจุงุฑููุฏ
    { wch: 12 }, // ุงูุณุนุฑ ูุจู
    { wch: 12 }, // ุงูุณุนุฑ ุจุนุฏ
    { wch: 18 }, // ุงูุชุตููู ุงูุงุณุงุณู
    { wch: 18 }, // ุงูุชุตููู ุงูุซุงููู
    { wch: 8 },  // ุงููุฑุน
    { wch: 10 }, // ุงููููู
    { wch: 35 }, // ุงูุตูุฑุฉ
    { wch: 15 }  // ุชุงุฑูุฎ ุงูุตูุงุญูู
];
worksheet['!cols'] = columnWidths;

// Create workbook
const workbook = xlsx.utils.book_new();
xlsx.utils.book_append_sheet(workbook, worksheet, 'Products');

// Write to file
const outputPath = join(__dirname, 'products_template.xlsx');
xlsx.writeFile(workbook, outputPath);

console.log('โ ุชู ุฅูุดุงุก ููู Excel ุจูุฌุงุญ!');
console.log('๐ ุงููุณุงุฑ:', outputPath);
console.log('๐ ุนุฏุฏ ุงูุตููู:', sampleData.length);
console.log('');
console.log('ููููู ุงูุขู ูุชุญ ุงูููู products_template.xlsx');
